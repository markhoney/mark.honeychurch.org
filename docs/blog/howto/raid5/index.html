<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Monitor a Linux RAID5 Rebuild | Mark Honeychurch</title>
    <meta name="description" content="Coder, Skeptic, Humanist">
    <link rel="apple-touch-icon" sizes="180x180" href="/media/images/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/media/images/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/media/images/icons/favicon-16x16.png">
  <link rel="manifest" href="/media/images/icons/site.webmanifest">
  <link rel="shortcut icon" href="/media/images/icons/favicon.ico">
  <meta name="msapplication-TileColor" content="#b91d47">
  <meta name="msapplication-config" content="/media/images/icons/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css">
  <link rel="alternate" type="application/rss+xml" href="https://mark.honeychurch.org/rss.xml" title="Mark Honeychurch RSS Feed">
  <link rel="alternate" type="application/atom+xml" href="https://mark.honeychurch.org/feed.atom" title="Mark Honeychurch Atom Feed">
  <link rel="alternate" type="application/json" href="https://mark.honeychurch.org/feed.json" title="Mark Honeychurch JSON Feed">
    <meta property="article:published_time" content="2008-08-24T00:00:00.000Z"><meta property="og:site_name" content="Mark Honeychurch"><meta property="og:title" content="Monitor a Linux RAID5 Rebuild"><meta property="og:description" content="My new NAS is currently rebuilding its RAID5 array, and I figured it&#39;d be good to watch the progress of the rebuild. To this end, I hacked together a quick and dirty script to display the contents of /proc/mdstat at one second intervals. Just place the below code in a file called mdinfo.sh (nano mdinfo.sh and paste), make it executable (chmod +x mdinfo.sh) and run it (./mdinfo.sh). To quit, just press Control-C."><meta property="og:type" content="article"><meta property="og:url" content="/blog/howto/raid5/"><meta property="og:image" content="/media/images/blog/howto/raid5.jpg"><meta name="twitter:title" content="Monitor a Linux RAID5 Rebuild"><meta name="twitter:description" content="My new NAS is currently rebuilding its RAID5 array, and I figured it&#39;d be good to watch the progress of the rebuild. To this end, I hacked together a quick and dirty script to display the contents of /proc/mdstat at one second intervals. Just place the below code in a file called mdinfo.sh (nano mdinfo.sh and paste), make it executable (chmod +x mdinfo.sh) and run it (./mdinfo.sh). To quit, just press Control-C."><meta name="twitter:url" content="/blog/howto/raid5/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="/media/images/blog/howto/raid5.jpg"><meta name="twitter:label1" content="Written by"><meta name="twitter:creator" content="@markhoney"><meta name="twitter:label2" content="Filed under"><meta name="twitter:data2" content="RAID5, MDADM, Rebuild"><meta property="article:tag" content="RAID5"><meta property="article:tag" content="MDADM"><meta property="article:tag" content="Rebuild">
    <link rel="preload" href="/assets/css/0.styles.css" as="style"><link rel="preload" href="/assets/js/styles.js" as="script"><link rel="preload" href="/assets/js/app.js" as="script"><link rel="preload" href="/assets/js/17.js" as="script"><link rel="preload" href="/assets/js/2.js" as="script"><link rel="preload" href="/assets/js/125.js" as="script"><link rel="preload" href="/assets/js/51.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Mark Honeychurch</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Blog</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/life/" class="nav-link">Life</a></li><li class="dropdown-item"><!----> <a href="/blog/random/" class="nav-link">Random</a></li><li class="dropdown-item"><!----> <a href="/blog/code/" class="nav-link">Code</a></li><li class="dropdown-item"><!----> <a href="/blog/howto/" class="nav-link router-link-active">How To</a></li><li class="dropdown-item"><!----> <a href="/blog/projects/" class="nav-link">Projects</a></li><li class="dropdown-item"><h4>Skeptical Thoughts</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/skepticism/2015/" class="nav-link">2015</a></li><li class="dropdown-subitem"><a href="/blog/skepticism/2016/" class="nav-link">2016</a></li><li class="dropdown-subitem"><a href="/blog/skepticism/2017/" class="nav-link">2017</a></li><li class="dropdown-subitem"><a href="/blog/skepticism/2018/" class="nav-link">2018</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/media/" class="nav-link">Media</a></div><div class="nav-item"><a href="/cv/" class="nav-link">CV</a></div><div class="nav-item"><a href="/contact/" class="nav-link">Contact</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Blog</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/life/" class="nav-link">Life</a></li><li class="dropdown-item"><!----> <a href="/blog/random/" class="nav-link">Random</a></li><li class="dropdown-item"><!----> <a href="/blog/code/" class="nav-link">Code</a></li><li class="dropdown-item"><!----> <a href="/blog/howto/" class="nav-link router-link-active">How To</a></li><li class="dropdown-item"><!----> <a href="/blog/projects/" class="nav-link">Projects</a></li><li class="dropdown-item"><h4>Skeptical Thoughts</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/skepticism/2015/" class="nav-link">2015</a></li><li class="dropdown-subitem"><a href="/blog/skepticism/2016/" class="nav-link">2016</a></li><li class="dropdown-subitem"><a href="/blog/skepticism/2017/" class="nav-link">2017</a></li><li class="dropdown-subitem"><a href="/blog/skepticism/2018/" class="nav-link">2018</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/media/" class="nav-link">Media</a></div><div class="nav-item"><a href="/cv/" class="nav-link">CV</a></div><div class="nav-item"><a href="/contact/" class="nav-link">Contact</a></div> <!----></nav>  <!----> </aside> <main class="page"><div data-v-54274349><!----> <h2 data-v-54274349>Monitor a Linux RAID5 Rebuild</h2> <h4 data-v-54274349>August 24, 2008</h4> <p data-v-54274349><!----> <em>Categories:</em> <span><a href="/blog/category/?name=Software">Software<!----></a></span> , <em>Tags:</em> <span><a href="/blog/tag/?name=RAID5">RAID5<span>, </span></a><a href="/blog/tag/?name=MDADM">MDADM<span>, </span></a><a href="/blog/tag/?name=Rebuild">Rebuild<!----></a></span></p></div> <div class="theme-default-content content__default"><p>My new NAS is currently rebuilding its RAID5 array, and I figured it'd be good to watch the progress of the rebuild. To this end, I hacked together a quick and dirty script to display the contents of /proc/mdstat at one second intervals. Just place the below code in a file called mdinfo.sh (nano mdinfo.sh and paste), make it executable (chmod +x mdinfo.sh) and run it (./mdinfo.sh). To quit, just press Control-C.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token shebang important">#!/bin/sh</span>

<span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">1</span>

<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">$i</span> -eq <span class="token number">1</span> <span class="token punctuation">]</span>
<span class="token keyword">do</span>
<span class="token function">clear</span>
<span class="token function">cat</span> /proc/mdstat
<span class="token function">sleep</span> <span class="token number">1</span>
<span class="token keyword">done</span>
</code></pre></div><p>To keep an eye on a file copy (I'll be copying 1.2Tb to my new NAS), you can just swap the command 'cat /proc/mdstat' for 'df' and/or 'df -h'. 'df' shows disk usage and 'df -h' shows disk usage in 'human readable' form. I use both, one after the other, so that I can see a) that the copy is running (as the 'human readable' format changes infrequently once the count is at 10GB or more, even over my gigabit network) and b) how long the copy has to go (as it's hard to work this out from looking at the disk space in 1k blocks). This script I called cpinfo.sh on my server:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token shebang important">#!/bin/sh</span>

<span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">1</span>

<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">$i</span> -eq <span class="token number">1</span> <span class="token punctuation">]</span>
<span class="token keyword">do</span>
<span class="token function">clear</span>
<span class="token function">df</span>
<span class="token builtin class-name">echo</span>
<span class="token function">df</span> -h
<span class="token function">sleep</span> <span class="token number">1</span>
<span class="token keyword">done</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> <footer data-v-5677641e><hr data-v-5677641e> <p data-v-5677641e><a href="http://fb.me/mark.honeychurch" target="_blank" rel="noopener noreferrer" data-v-5677641e><i class="fab fa-facebook-f" data-v-5677641e></i>
			Facebook
		</a>
		|
		<a href="https://twitter.com/markhoney" target="_blank" rel="noopener noreferrer" data-v-5677641e><i class="fab fa-twitter" data-v-5677641e></i>
			Twitter
		</a>
		|
		<a href="https://www.linkedin.com/in/markhoneychurch" target="_blank" rel="noopener noreferrer" data-v-5677641e><i class="fab fa-linkedin-in" data-v-5677641e></i>
			LinkedIn
		</a>
		|
		<a href="https://github.com/markhoney" target="_blank" rel="noopener noreferrer" data-v-5677641e><i class="fab fa-github" data-v-5677641e></i>
			Github
		</a>
		|
		<a href="/contact/" data-v-5677641e><i class="fa fa-envelope" data-v-5677641e></i>
			Contact
		</a></p> <p data-v-5677641e><a href="https://mark.honeychurch.org/rss.xml" target="_blank" rel="noopener noreferrer" data-v-5677641e><i class="fas fa-rss" data-v-5677641e></i>
			RSS
		</a>
		|
		<a href="https://mark.honeychurch.org/feed.atom" target="_blank" rel="noopener noreferrer" data-v-5677641e><i class="fas fa-atom" data-v-5677641e></i>
			Atom
		</a>
		|
		<a href="https://mark.honeychurch.org/feed.json" target="_blank" rel="noopener noreferrer" data-v-5677641e><i class="fab fa-js" data-v-5677641e></i>
			JSON
		</a></p> <p data-v-5677641e>Copyright © 2019 Mark Honeychurch</p></footer></main></div><div class="global-ui"><div class="reading-progress top" data-v-7681808f><div class="progress" data-v-7681808f></div></div><!----></div></div>
    <script src="/assets/js/styles.js" defer></script><script src="/assets/js/17.js" defer></script><script src="/assets/js/2.js" defer></script><script src="/assets/js/125.js" defer></script><script src="/assets/js/51.js" defer></script><script src="/assets/js/app.js" defer></script>
  </body>
</html>
